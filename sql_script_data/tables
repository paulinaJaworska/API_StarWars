DROP TABLE IF EXISTS votes;
ALTER TABLE IF EXISTS ONLY public.user_data DROP CONSTRAINT IF EXISTS pk_user_data_id CASCADE;

CREATE TABLE votes (
                       id SERIAL PRIMARY KEY,
                       planet character varying(255) NOT NULL,
                       votes character varying(255) NOT NULL);


DROP TABLE IF EXISTS public.user_data;
CREATE TABLE user_data (
                           id serial NOT NULL,
                           login text NOT NULL ,
                           password text NOT NULL,
                           registration_date TIMESTAMP WITHOUT TIME ZONE,
                           prestige_points integer DEFAULT 0

);

ALTER TABLE ONLY user_data
    ADD CONSTRAINT pk_user_data_id PRIMARY KEY (id);

ALTER TABLE ONLY question
    ADD CONSTRAINT fk_user_id FOREIGN KEY (user_id) REFERENCES user_data(id);

ALTER TABLE ONLY answer
    ADD CONSTRAINT fk_user_id FOREIGN KEY (user_id) REFERENCES user_data(id);

ALTER TABLE ONLY comment
    ADD CONSTRAINT fk_user_id FOREIGN KEY (user_id) REFERENCES user_data(id);


INSERT INTO user_data VALUES (1, 'magg', '$2b$12$PFUPLLBw7pp/ORjxpaZ6w.UPs0acqorXM5a4YaFsEAgLUJu/XBrXa',	'2019-02-08 00:31:00.000000',	200);
INSERT INTO user_data VALUES (2,	'admin',	'$2b$12$kVMmDh76EtbuJmL2J0oL7ujhExNLlI9tUAw4gkMTaHMmSIBN4CYMK',	'2019-02-08 00:37:00.000000',	135);

SELECT pg_catalog.setval('user_data_id_seq', (SELECT MAX(id) from "user_data"), true);
